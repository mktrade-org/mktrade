{% extends "base.html" %}

{% block title %}Keys{% endblock %}

{% block content %}

<script>
    function account_change(val) {
        if(val) {
            window.location.href = val;
        }
    }
</script>

<select onchange="account_change(this.value);">
    <option value="{{ url_for('keystore.keys') }}"{% if not current_account %} selected{% endif %}>New</option>
    {% for account in accounts %}
    <option value="{{ url_for('keystore.keys_by_id', key_id=account.account_id) }}" {% if current_account and current_account.account_id == account.account_id %} selected{% endif %}>{{ account.account_id }} - {{ account.account_tag }}</option>
    {% endfor %}
</select>

<form method="post" action="{% if not current_account %}{{ url_for('keystore.keys') }}{% else %}{{ url_for('keystore.keys_by_id', key_id=current_account.account_id) }}{% endif %}">
    Tag:
    <input name="tag" type="text" required value="{% if current_account %}{{ current_account.account_tag }}{% endif %}"/>
    Exchange:
    <select name="exchange">
        {% for exchange in exchanges %}
        <option value="{{ exchange }}"{% if current_account and current_account.exchange_id == exchange %} selected{% endif %}>{{ exchange }}</option>
        {% endfor %}
    </select>
    Api key:
    <input name="api_key" type="text" required value="{% if current_account %}{{ current_account.api_key }}{% endif %}"/>
    Api secret:
    <input name="api_secret" type="text" required value="{% if current_account %}{{ current_account.api_secret }}{% endif %}"/>
    UID:
    <input name="uid" type="text" value="{% if current_account %}{{ current_account.uid }}{% endif %}"/>
    Password:
    <input name="pass" type="text" value="{% if current_account %}{{ current_account.password }}{% endif %}"/>
    Timeout:
    <input name="timeout" type="text" value="{% if current_account %}{{ current_account.exchange_timeout }}{% else %}10000{% endif %}"/>
    <input name="nonce_as_time" type="checkbox"{% if current_account and current_account.nonce_as_time%} checked{% endif %}/> Nonce as time
    <input name="act" type="hidden" value="add">
    <input name="csrf_token" type="hidden" value="{{ csrf_token }}"/>
    <input type="submit" value="Save"/>
</form>
{% if current_account %}
<form method="post">
    <input name="act" type="hidden" value="del">
    <input name="csrf_token" type="hidden" value="{{ csrf_token }}">
    <input type="submit" value="Delete"/>
</form>
{% endif %}
{% endblock %}